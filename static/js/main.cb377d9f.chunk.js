(this.webpackJsonppuv=this.webpackJsonppuv||[]).push([[0],{69:function(e,t,n){e.exports=n(97)},74:function(e,t,n){},75:function(e,t,n){},76:function(e,t,n){},97:function(e,t,n){"use strict";n.r(t);var a=n(0),o=n.n(a),r=n(6),c=n.n(r),i=(n(74),n(75),n(76),n(131)),l=n(134),u=n(61),s=n(133),m=n(130),p=n(55),h=new(n.n(p).a)({accessKey:"50ed87a710c800dc9bbe33a4a18ae37cb7d51679978da874ce6037c158b74af3",secret:"2728066a53a960c2899775cc7e9731282b5cf861111d88a595d0894e3c2024cb",callbackUrl:"https://igvsiii.github.io/puv/"}),f=h.auth.getAuthenticationUrl(["public","read_user","read_photos","write_likes"]),d=function(e,t,n){return h.auth.setBearerToken(n),h.photos.listPhotos(e,t,"latest").then((function(e){return e.json()}))},E=n(18),b=function(e){return{type:"GET_USER",token:e}},k=n(22);var v=Object(E.b)((function(e){return{user:e.user.token}}),(function(e){return{setToken:function(t){return e(b(t))}}}))((function(e){var t=e.user,n=e.setToken,r=Object(k.f)(),c=window.location.search.split("code=")[1],p=Object(u.a)({palette:{primary:m.a}});return Object(a.useEffect)((function(){void 0!==c&&function(e,t){h.auth.userAuthentication(e).then((function(e){return e.json()})).then((function(e){t(e.access_token)}))}(c,n)}),[c]),Object(a.useEffect)((function(){t&&r.push("/puv/main/")}),[t]),o.a.createElement("div",null,o.a.createElement(i.a,{className:"backImg"},o.a.createElement("div",{className:"wrap"},o.a.createElement(s.a,{theme:p},o.a.createElement(l.a,{variant:"contained",color:"primary",size:"large",onClick:function(){document.location.assign(f)}},void 0===c?"\u0410\u0432\u0442\u043e\u0440\u0438\u0437\u043e\u0432\u0430\u0442\u044c\u0441\u044f":"...")))))})),g=n(62),O=n(136),j=n(137),y=n(135),w=n(146),_=n(145),T=n(139),z=n(58),N=n.n(z),I=n(138),P=Object(y.a)((function(e){return{root:{flexGrow:1},menuButton:{marginRight:e.spacing(2)},title:{flexGrow:1}}}));var B=Object(E.b)((function(e){return{user:e.user.token}}),(function(e){return{setToken:function(t){return e(b(t))}}}))((function(e){var t=e.user,n=e.setToken,a=P(),r=o.a.useState(null),c=Object(g.a)(r,2),i=c[0],l=c[1],p=Boolean(i),h=Object(u.a)({palette:{primary:m.a}}),f=Object(k.f)(),d=null;return d=t?o.a.createElement(w.a,{onClick:function(){n(""),f.push("/puv/")}},"\u0412\u044b\u0439\u0442\u0438"):o.a.createElement(w.a,{onClick:function(){f.push("/puv/")}},"\u0412\u044b \u043d\u0435 \u0430\u0432\u0442\u043e\u0440\u0438\u0437\u043e\u0432\u0430\u043d\u044b"),o.a.createElement("div",{className:a.root},o.a.createElement(s.a,{theme:h},o.a.createElement(O.a,{position:"static",color:"primary"},o.a.createElement(j.a,null,o.a.createElement(I.a,{variant:"h6",className:a.title},"Photos app"),o.a.createElement(T.a,{"aria-label":"account of current user","aria-controls":"menu-appbar","aria-haspopup":"true",onClick:function(e){l(e.currentTarget)},color:"inherit"},o.a.createElement(N.a,null)),o.a.createElement(_.a,{id:"menu-appbar",anchorEl:i,anchorOrigin:{vertical:"top",horizontal:"right"},keepMounted:!0,transformOrigin:{vertical:"top",horizontal:"right"},open:p,onClose:function(){l(null)}},d)))))})),x=n(140),L=n(141),C=n(142),S=n(17),U=n(60),G=n.n(U),K=n(59),H=n.n(K),D=Object(y.a)((function(e){return{root:{display:"flex",flexWrap:"wrap",justifyContent:"space-around",overflow:"hidden",backgroundColor:e.palette.background.paper,paddingTop:20},gridList:{width:500},titleBar:{background:"linear-gradient(to bottom, rgba(0,0,0,0.7) 0%, rgba(0,0,0,0.3) 70%, rgba(0,0,0,0) 100%)"},icon:{color:"white"}}}));var R=Object(E.b)((function(e){return{user:e.user.token,photos:e.photos.elem,size:e.photos.size}}),(function(e){return{setPhoto:function(t){return e({type:"GET_PHOTOS",newPhoto:t})},setLike:function(t){return e({type:"LIKE",photoID:t})},setUnlike:function(t){return e({type:"UNLIKE",photoID:t})}}}))((function(e){var t=e.user,n=e.photos,a=e.size,r=e.setPhoto,c=e.setLike,i=e.setUnlike,l=D(),u=a;0===a&&d(1,12,t).then((function(e){return r(e)})),window.addEventListener("scroll",(function(){document.documentElement.scrollHeight-10<document.documentElement.clientHeight+document.documentElement.scrollTop&&u===a&&0!==a&&(d(a+1,a+12,t).then((function(e){return r(e)})),u++)}));var s=function(e){t&&(!function(e,t){h.auth.setBearerToken(t),h.photos.likePhoto(e).then((function(e){return e.json()})).then((function(e){}))}(e,t),c(e))},m=function(e){t&&(!function(e,t){h.auth.setBearerToken(t),h.photos.unlikePhoto(e).then((function(e){return e.json()})).then((function(e){}))}(e,t),i(e))};return o.a.createElement("div",{className:l.root},o.a.createElement(x.a,{className:l.gridList,cols:3},n.map((function(e,t){return o.a.createElement(L.a,{key:e.id+t,cols:1},o.a.createElement(S.b,{to:"/puv/photo/"+t},o.a.createElement("img",{src:e.urls.small,alt:e.alt_description})),o.a.createElement(C.a,{title:e.likes,titlePosition:"top",onClick:e.liked_by_user?function(t){m(e.id)}:function(t){s(e.id)},actionIcon:o.a.createElement(T.a,{"aria-label":"star ".concat(e.title),className:l.icon},e.liked_by_user?o.a.createElement(H.a,null):o.a.createElement(G.a,null)),actionPosition:"left",className:l.titleBar}))}))))}));var W=function(){return o.a.createElement("div",null,o.a.createElement(B,null),o.a.createElement(R,null))},A=n(143),J=n(144),M=Object(y.a)({root:{minWidth:320},bullet:{display:"inline-block",margin:"0 2px",transform:"scale(0.8)"},title:{fontSize:14},pos:{marginBottom:12}});var q=Object(E.b)((function(e,t){return{photo:e.photos.elem[t.match.params.photoId]}}))((function(e){var t=e.photo,n=M();return void 0===t?o.a.createElement("div",null,o.a.createElement("h2",null,"\u0424\u043e\u0442\u043e \u043d\u0435 \u043d\u0430\u0439\u0434\u0435\u043d\u043e"),o.a.createElement(S.b,{to:"/puv/main/"},"\u041d\u0430\u0437\u0430\u0434")):o.a.createElement("div",null,o.a.createElement(A.a,{className:n.root},o.a.createElement(J.a,null,o.a.createElement(I.a,{className:n.title,color:"textSecondary",gutterBottom:!0},"\u0410\u0432\u0442\u043e\u0440: ",o.a.createElement("a",{href:t.user.links.html,target:"_blank"}," ",t.user.name," ")),o.a.createElement(I.a,{className:n.pos,color:"textSecondary"},"\u0414\u0430\u0442\u0430 \u043f\u0443\u0431\u043b\u0438\u043a\u0430\u0446\u0438\u0438:  ",t.created_at),o.a.createElement(S.b,{to:"/puv/main/"},o.a.createElement("img",{src:t.urls.raw,width:.8*document.documentElement.clientWidth})))))}));var F=function(){return o.a.createElement("div",null,o.a.createElement(k.c,null,o.a.createElement(k.a,{exact:!0,path:"/puv/",component:v}),o.a.createElement(k.a,{path:"/puv/main/",component:W}),o.a.createElement(k.a,{path:"/puv/photo/:photoId",component:q})))},Q=n(26),V=n(33),X=Object(Q.b)({photos:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{size:0,elem:[]},t=arguments.length>1?arguments[1]:void 0,n=t.type,a=t.newPhoto,o=t.photoID;switch(n){case"GET_PHOTOS":return{size:e.size+12,elem:e.elem.concat(a)};case"LIKE":return{size:e.size,elem:e.elem.map((function(e){return e.id===o?Object(V.a)(Object(V.a)({},e),{},{likes:++e.likes,liked_by_user:!0}):e}))};case"UNLIKE":return{size:e.size,elem:e.elem.map((function(e){return e.id===o?Object(V.a)(Object(V.a)({},e),{},{likes:--e.likes,liked_by_user:!1}):e}))};default:return e}},user:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{token:""},t=arguments.length>1?arguments[1]:void 0,n=t.type,a=t.token;switch(n){case"GET_USER":return{token:a};default:return e}}}),Y=Object(Q.c)(X);c.a.render(o.a.createElement(E.a,{store:Y},o.a.createElement(S.a,null,o.a.createElement(F,null))),document.getElementById("root"))}},[[69,1,2]]]);
//# sourceMappingURL=main.cb377d9f.chunk.js.map